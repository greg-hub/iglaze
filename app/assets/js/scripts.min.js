/*!
 * iglaze
 * 
 * 
 * @author Greg Clinton
 * @version 1.0.0
 * Copyright 2017. MIT licensed.
 */
!function(e,t){"use strict";"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.ContactForm=t()}(this,function(){"use strict";var e=function(t,s){return this&&this instanceof e?void(t&&s&&(this.form=t instanceof Node?t:document.querySelector(t),this.endpoint=s.endpoint,this.send())):new e(t,s)};return e.prototype={hasClass:function(e,t){return new RegExp("(\\s|^)"+t+"(\\s|$)").test(e.className)},addClass:function(e,t){this.hasClass(e,t)||(e.className+=(e.className?" ":"")+t)},removeClass:function(e,t){this.hasClass(e,t)&&(e.className=e.className.replace(new RegExp("(\\s|^)"+t+"(\\s|$)")," ").replace(/^\s+|\s+$/g,""))},each:function(e,t){var s,r;for(s=0,r=e.length;s<r;s+=1)t(e[s],s,e)},template:function(e,t){var s;for(s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e=e.replace(new RegExp("{"+s+"}","g"),t[s]));return e},empty:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},removeElementsByClass:function(e){for(var t=document.getElementsByClassName(e);t.length>0;)t[0].parentNode.removeChild(t[0])},post:function(e,t,s,r){var n=new XMLHttpRequest;n.open("POST",e,!0),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.onreadystatechange=function(){if(4===this.readyState)if(200===this.status){var e="";try{e=JSON.parse(this.responseText)}catch(t){e=this.responseText}s.call(this,e)}else r.call(this,this.responseText)},n.send(t),n=null},param:function(e){var t="string"==typeof e?e:Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&");return t},send:function(){this.form.addEventListener("submit",function(e){e.preventDefault();var t,s=document.querySelectorAll(".form-control");this.each(s,function(e,t){this.hasClass(e.parentNode,"has-error")&&(this.removeClass(e.parentNode,"has-error"),this.removeElementsByClass("help-block"))}.bind(this)),t={name:document.querySelector('input[name="form-name"]').value,email:document.querySelector('input[name="form-email"]').value,subject:document.querySelector('input[name="form-subject"]').value,message:document.querySelector('textarea[name="form-message"]').value},this.post(this.endpoint,this.param(t),this.feedback.bind(this),this.fail.bind(this))}.bind(this),!1)},feedback:function(e){if(e.success){var t=this.template('<div class="alert alert-success">{report}</div>',{report:e.message});this.empty(this.form),this.form.insertAdjacentHTML("beforeend",t)}else{if(e.errors.name){var s,r=document.querySelector('input[name="form-name"]').parentNode;this.addClass(r,"has-error"),s=this.template('<span class="help-block">{report}</span>',{report:e.errors.name}),r.insertAdjacentHTML("beforeend",s)}if(e.errors.email){var s,n=document.querySelector('input[name="form-email"]').parentNode;this.addClass(n,"has-error"),s=this.template('<span class="help-block">{report}</span>',{report:e.errors.email}),n.insertAdjacentHTML("beforeend",s)}if(e.errors.subject){var s,a=document.querySelector('input[name="form-subject"]').parentNode;this.addClass(a,"has-error"),s=this.template('<span class="help-block">{report}</span>',{report:e.errors.subject}),a.insertAdjacentHTML("beforeend",s)}if(e.errors.message){var s,o=document.querySelector('textarea[name="form-message"]').parentNode;this.addClass(o,"has-error"),s=this.template('<span class="help-block">{report}</span>',{report:e.errors.message}),o.insertAdjacentHTML("beforeend",s)}}},fail:function(e){console.log(e)}},e});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMuanMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJkZWZpbmUiLCJhbWQiLCJleHBvcnRzIiwibW9kdWxlIiwiQ29udGFjdEZvcm0iLCJ0aGlzIiwiZm9ybSIsIm9wdGlvbnMiLCJOb2RlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZW5kcG9pbnQiLCJzZW5kIiwicHJvdG90eXBlIiwiaGFzQ2xhc3MiLCJlbCIsIm5hbWUiLCJSZWdFeHAiLCJ0ZXN0IiwiY2xhc3NOYW1lIiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsInJlcGxhY2UiLCJlYWNoIiwiY29sbGVjdGlvbiIsIml0ZXJhdG9yIiwiaSIsImxlbiIsImxlbmd0aCIsInRlbXBsYXRlIiwic3RyaW5nIiwiZGF0YSIsInBpZWNlIiwiT2JqZWN0IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiZW1wdHkiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJyZW1vdmVFbGVtZW50c0J5Q2xhc3MiLCJlbGVtZW50cyIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJwYXJlbnROb2RlIiwicG9zdCIsInBhdGgiLCJzdWNjZXNzIiwiZmFpbCIsInhodHRwIiwiWE1MSHR0cFJlcXVlc3QiLCJvcGVuIiwic2V0UmVxdWVzdEhlYWRlciIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlYWR5U3RhdGUiLCJzdGF0dXMiLCJyZXNwb25zZSIsIkpTT04iLCJwYXJzZSIsInJlc3BvbnNlVGV4dCIsImVyciIsInBhcmFtIiwicGFyYW1zIiwia2V5cyIsIm1hcCIsImsiLCJlbmNvZGVVUklDb21wb25lbnQiLCJqb2luIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImZvcm1EYXRhIiwicXVlcnlTZWxlY3RvckFsbCIsImJpbmQiLCJ2YWx1ZSIsImVtYWlsIiwic3ViamVjdCIsIm1lc3NhZ2UiLCJmZWVkYmFjayIsInJlcG9ydCIsImluc2VydEFkamFjZW50SFRNTCIs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RSxTQUFBQyxjQUFBLDhCQUFBZ0MsVUFHQXJDLE1BQUFlLFNBQUFzRCxFQUFBLGFBQ0FNLEVBQUEzRSxLQUFBd0IsU0FDQSw0Q0FDQWdELE9BQUE5QyxFQUFBZ0QsT0FBQUwsVUFHQUEsRUFBQUksbUJBQUEsWUFBQUUsR0FHQSxHQUFBakQsRUFBQWdELE9BQUFKLFFBQUEsQ0FDQSxHQUNBSyxHQURBTCxFQUFBbEUsU0FBQUMsY0FBQSxpQ0FBQWdDLFVBR0FyQyxNQUFBZSxTQUFBdUQsRUFBQSxhQUNBSyxFQUFBM0UsS0FBQXdCLFNBQ0EsNENBQ0FnRCxPQUFBOUMsRUFBQWdELE9BQUFKLFVBR0FBLEVBQUFHLG1CQUFBLFlBQUFFLE1BWUFsQyxLQUFBLFNBQUFmLEdBQ0FrRCxRQUFBQyxJQUFBbkQsS0FJQTNCIiwiZmlsZSI6InNjcmlwdHMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcclxuICAgICAgICBkZWZpbmUoW10sIGZhY3RvcnkpO1xyXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcm9vdC5Db250YWN0Rm9ybSA9IGZhY3RvcnkoKTtcclxuICAgIH1cclxufSh0aGlzLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICB2YXIgQ29udGFjdEZvcm0gPSBmdW5jdGlvbiAoZm9ybSwgb3B0aW9ucykge1xyXG4gICAgICAgIGlmICghdGhpcyB8fCAhKHRoaXMgaW5zdGFuY2VvZiBDb250YWN0Rm9ybSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBDb250YWN0Rm9ybShmb3JtLCBvcHRpb25zKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghZm9ybSB8fCAhb3B0aW9ucykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmZvcm0gICAgID0gZm9ybSBpbnN0YW5jZW9mIE5vZGUgPyBmb3JtIDogZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihmb3JtKTtcclxuICAgICAgICB0aGlzLmVuZHBvaW50ID0gb3B0aW9ucy5lbmRwb2ludDtcclxuXHJcbiAgICAgICAgdGhpcy5zZW5kKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIENvbnRhY3RGb3JtLnByb3RvdHlwZSA9IHtcclxuICAgICAgICBoYXNDbGFzczogZnVuY3Rpb24gKGVsLCBuYW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVnRXhwKCcoXFxcXHN8XiknICsgbmFtZSArICcoXFxcXHN8JCknKS50ZXN0KGVsLmNsYXNzTmFtZSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBhZGRDbGFzczogZnVuY3Rpb24gKGVsLCBuYW1lKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5oYXNDbGFzcyhlbCwgbmFtZSkpIHtcclxuICAgICAgICAgICAgICAgIGVsLmNsYXNzTmFtZSArPSAoZWwuY2xhc3NOYW1lID8gJyAnIDogJycpICsgbmFtZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uIChlbCwgbmFtZSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5oYXNDbGFzcyhlbCwgbmFtZSkpIHtcclxuICAgICAgICAgICAgICAgIGVsLmNsYXNzTmFtZSA9IGVsLmNsYXNzTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoJyhcXFxcc3xeKScgKyBuYW1lICsgJyhcXFxcc3wkKScpLCAnICcpLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZWFjaDogZnVuY3Rpb24gKGNvbGxlY3Rpb24sIGl0ZXJhdG9yKSB7XHJcbiAgICAgICAgICAgIHZhciBpLCBsZW47XHJcblxyXG4gICAgICAgICAgICBmb3IgKGkgPSAwLCBsZW4gPSBjb2xsZWN0aW9uLmxlbmd0aDsgaSA8IGxlbjsgaSArPSAxKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVyYXRvcihjb2xsZWN0aW9uW2ldLCBpLCBjb2xsZWN0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGVtcGxhdGU6IGZ1bmN0aW9uIChzdHJpbmcsIGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIHBpZWNlO1xyXG5cclxuICAgICAgICAgICAgZm9yIChwaWVjZSBpbiBkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGRhdGEsIHBpZWNlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0cmluZyA9IHN0cmluZy5yZXBsYWNlKG5ldyBSZWdFeHAoJ3snICsgcGllY2UgKyAnfScsICdnJyksIGRhdGFbcGllY2VdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHN0cmluZztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVtcHR5OiBmdW5jdGlvbiAoZWwpIHtcclxuICAgICAgICAgICAgd2hpbGUgKGVsLmZpcnN0Q2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIGVsLnJlbW92ZUNoaWxkKGVsLmZpcnN0Q2hpbGQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICByZW1vdmVFbGVtZW50c0J5Q2xhc3M6IGZ1bmN0aW9uIChjbGFzc05hbWUpIHtcclxuICAgICAgICAgICAgdmFyIGVsZW1lbnRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShjbGFzc05hbWUpO1xyXG5cclxuICAgICAgICAgICAgd2hpbGUoZWxlbWVudHMubGVuZ3RoID4gMCl7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50c1swXS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsZW1lbnRzWzBdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcG9zdDogZnVuY3Rpb24gKHBhdGgsIGRhdGEsIHN1Y2Nlc3MsIGZhaWwpIHtcclxuICAgICAgICAgICAgdmFyIHhodHRwID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcblxyXG4gICAgICAgICAgICB4aHR0cC5vcGVuKCdQT1NUJywgcGF0aCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHhodHRwLnNldFJlcXVlc3RIZWFkZXIoJ1gtUmVxdWVzdGVkLVdpdGgnLCAnWE1MSHR0cFJlcXVlc3QnKTtcclxuICAgICAgICAgICAgeGh0dHAuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCcpO1xyXG4gICAgICAgICAgICB4aHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yZWFkeVN0YXRlID09PSA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZSA9IEpTT04ucGFyc2UodGhpcy5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gdGhpcy5yZXNwb25zZVRleHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2Vzcy5jYWxsKHRoaXMsIHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWlsLmNhbGwodGhpcywgdGhpcy5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgeGh0dHAuc2VuZChkYXRhKTtcclxuICAgICAgICAgICAgeGh0dHAgPSBudWxsO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcGFyYW06IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycgPyBkYXRhIDogT2JqZWN0LmtleXMoZGF0YSkubWFwKFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGspIHsgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChrKSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudChkYXRhW2tdKTsgfVxyXG4gICAgICAgICAgICApLmpvaW4oJyYnKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBwYXJhbXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZW5kOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mb3JtLWNvbnRyb2wnKSxcclxuICAgICAgICAgICAgICAgICAgICBmb3JtRGF0YTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmVhY2goZWxlbWVudHMsIGZ1bmN0aW9uIChlbCwgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc0NsYXNzKGVsLnBhcmVudE5vZGUsICdoYXMtZXJyb3InKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUNsYXNzKGVsLnBhcmVudE5vZGUsICdoYXMtZXJyb3InKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVFbGVtZW50c0J5Q2xhc3MoJ2hlbHAtYmxvY2snKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICAgICAgICAgIGZvcm1EYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICduYW1lJyAgICA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJmb3JtLW5hbWVcIl0nKS52YWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAnZW1haWwnICAgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwiZm9ybS1lbWFpbFwiXScpLnZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgICdzdWJqZWN0JyA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJmb3JtLXN1YmplY3RcIl0nKS52YWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAnbWVzc2FnZScgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd0ZXh0YXJlYVtuYW1lPVwiZm9ybS1tZXNzYWdlXCJdJykudmFsdWVcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5wb3N0KHRoaXMuZW5kcG9pbnQsIHRoaXMucGFyYW0oZm9ybURhdGEpLCB0aGlzLmZlZWRiYWNrLmJpbmQodGhpcyksIHRoaXMuZmFpbC5iaW5kKHRoaXMpKTtcclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCBmYWxzZSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBmZWVkYmFjazogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgaWYgKCFkYXRhLnN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLmVycm9ycy5uYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwiZm9ybS1uYW1lXCJdJykucGFyZW50Tm9kZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkQ2xhc3MobmFtZSwgJ2hhcy1lcnJvcicpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yID0gdGhpcy50ZW1wbGF0ZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwiaGVscC1ibG9ja1wiPntyZXBvcnR9PC9zcGFuPicsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVwb3J0OiBkYXRhLmVycm9ycy5uYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWUuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCBlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuZXJyb3JzLmVtYWlsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVtYWlsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cImZvcm0tZW1haWxcIl0nKS5wYXJlbnROb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRDbGFzcyhlbWFpbCwgJ2hhcy1lcnJvcicpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yID0gdGhpcy50ZW1wbGF0ZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwiaGVscC1ibG9ja1wiPntyZXBvcnR9PC9zcGFuPicsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVwb3J0OiBkYXRhLmVycm9ycy5lbWFpbFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBlbWFpbC5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsIGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5lcnJvcnMuc3ViamVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWJqZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cImZvcm0tc3ViamVjdFwiXScpLnBhcmVudE5vZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZENsYXNzKHN1YmplY3QsICdoYXMtZXJyb3InKTtcclxuICAgICAgICAgICAgICAgICAgICBlcnJvciA9IHRoaXMudGVtcGxhdGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cImhlbHAtYmxvY2tcIj57cmVwb3J0fTwvc3Bhbj4nLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcG9ydDogZGF0YS5lcnJvcnMuc3ViamVjdFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzdWJqZWN0Lmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLmVycm9ycy5tZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd0ZXh0YXJlYVtuYW1lPVwiZm9ybS1tZXNzYWdlXCJdJykucGFyZW50Tm9kZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkQ2xhc3MobWVzc2FnZSwgJ2hhcy1lcnJvcicpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yID0gdGhpcy50ZW1wbGF0ZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwiaGVscC1ibG9ja1wiPntyZXBvcnR9PC9zcGFuPicsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVwb3J0OiBkYXRhLmVycm9ycy5tZXNzYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCBlcnJvcik7ICBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdGhpcy50ZW1wbGF0ZShcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LXN1Y2Nlc3NcIj57cmVwb3J0fTwvZGl2PicsIHtcclxuICAgICAgICAgICAgICAgICAgICByZXBvcnQ6IGRhdGEubWVzc2FnZVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5lbXB0eSh0aGlzLmZvcm0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtLmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgc3VjY2Vzcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGZhaWw6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIENvbnRhY3RGb3JtO1xyXG59KSk7Il19
